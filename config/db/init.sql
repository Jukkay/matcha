CREATE DATABASE IF NOT EXISTS matcha;
USE matcha;
CREATE TABLE IF NOT EXISTS users(
	`user_id` INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
	username VARCHAR(32) NOT NULL,
	`password` VARCHAR(255) NOT NULL,
	`name` VARCHAR(255) DEFAULT username,
	email VARCHAR(320) NOT NULL,
	profile_image VARCHAR(255) DEFAULT "default.png",
	biography VARCHAR(4096),
	gender VARCHAR(255) NOT NULL,
	gender_preference VARCHAR(255) NOT NULL,
	validation_key VARCHAR(255) NOT NULL,
	validated BOOLEAN DEFAULT FALSE,
	password_reset_key VARCHAR(255),
	`admin` BOOLEAN DEFAULT FALSE,
	email_notification BOOLEAN  DEFAULT TRUE,
	location_gps VARCHAR(255),
	location_city VARCHAR(255),
	UNIQUE (email, username),
	PRIMARY KEY (`user_id`)
);

CREATE TABLE IF NOT EXISTS photos(
	photo_id BIGINT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
	`user_id` INT(10) UNSIGNED NOT NULL,
	image_file VARCHAR(1024),
	likes INT UNSIGNED DEFAULT 0,
	comments INT UNSIGNED DEFAULT 0,
	creation_date DATETIME DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (photo_id)
);

CREATE TABLE IF NOT EXISTS comments(
	comment_id BIGINT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
	photo_id BIGINT(10) UNSIGNED NOT NULL,
	`user_id` INT(10) UNSIGNED NOT NULL,
	comment VARCHAR(4096),
	comment_date DATETIME DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (comment_id)
);

CREATE TABLE IF NOT EXISTS likes(
	like_id BIGINT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
	photo_id BIGINT(10) UNSIGNED NOT NULL,
	`user_id` INT(10) UNSIGNED NOT NULL,
	like_date DATETIME DEFAULT CURRENT_TIMESTAMP,
	PRIMARY KEY (like_id)
);

CREATE TABLE IF NOT EXISTS chats(
	chat_id BIGINT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
	user1 INT(10) UNSIGNED NOT NULL,
	user2 INT(10) UNSIGNED NOT NULL,
	PRIMARY KEY (chat_id)
);

CREATE TABLE IF NOT EXISTS messages(
	message_id BIGINT(10) UNSIGNED NOT NULL AUTO_INCREMENT,
	message_time DATETIME DEFAULT CURRENT_TIMESTAMP,
	chat_id BIGINT(10) UNSIGNED NOT NULL,
	`user_id` INT(10) UNSIGNED NOT NULL,
	message_text text NOT NULL,
	PRIMARY KEY (message_id)
);
